{"ast":null,"code":"import SockJS from 'sockjs-client';\nimport { Stomp } from 'stompjs';\nclass NotificationService {\n  constructor() {\n    this.stompClient = null;\n    this.connected = false;\n  }\n  connect(callback) {\n    const socketFactory = () => new SockJS('http://localhost:8080/ws');\n    this.stompClient = new StompClient({\n      webSocketFactory: socketFactory,\n      reconnectDelay: 5000,\n      onConnect: () => {\n        this.connected = true;\n        console.log('Connected to WebSocket');\n        this.stompClient.subscribe('/topic/notifications', message => {\n          const notification = JSON.parse(message.body);\n          callback({\n            type: 'new_request',\n            data: notification\n          });\n        });\n      },\n      onStompError: frame => {\n        console.error('Broker reported error:', frame.headers['message']);\n        console.error('Additional details:', frame.body);\n      },\n      onWebSocketClose: () => {\n        this.connected = false;\n        console.warn('WebSocket connection closed');\n      },\n      debug: () => {}\n    });\n    this.stompClient.activate();\n  }\n  disconnect() {\n    if (this.stompClient) {\n      this.stompClient.deactivate();\n      this.connected = false;\n      console.log('Disconnected from WebSocket');\n    }\n  }\n  isConnected() {\n    return this.connected;\n  }\n}\nconst notificationService = new NotificationService();\nexport default notificationService;","map":{"version":3,"names":["SockJS","Stomp","NotificationService","constructor","stompClient","connected","connect","callback","socketFactory","StompClient","webSocketFactory","reconnectDelay","onConnect","console","log","subscribe","message","notification","JSON","parse","body","type","data","onStompError","frame","error","headers","onWebSocketClose","warn","debug","activate","disconnect","deactivate","isConnected","notificationService"],"sources":["/Users/admin/happygo/frontend/src/services/NotificationService.js"],"sourcesContent":["import SockJS from 'sockjs-client';\nimport { Stomp } from 'stompjs';\n\nclass NotificationService {\n  constructor() {\n    this.stompClient = null;\n    this.connected = false;\n  }\n\n  connect(callback) {\n    const socketFactory = () => new SockJS('http://localhost:8080/ws');\n    this.stompClient = new StompClient({\n      webSocketFactory: socketFactory,\n      reconnectDelay: 5000,\n      onConnect: () => {\n        this.connected = true;\n        console.log('Connected to WebSocket');\n        this.stompClient.subscribe('/topic/notifications', (message) => {\n          const notification = JSON.parse(message.body);\n          callback({\n            type: 'new_request',\n            data: notification\n          });\n        });\n      },\n      onStompError: (frame) => {\n        console.error('Broker reported error:', frame.headers['message']);\n        console.error('Additional details:', frame.body);\n      },\n      onWebSocketClose: () => {\n        this.connected = false;\n        console.warn('WebSocket connection closed');\n      },\n      debug: () => {}\n    });\n    this.stompClient.activate();\n  }\n\n  disconnect() {\n    if (this.stompClient) {\n      this.stompClient.deactivate();\n      this.connected = false;\n      console.log('Disconnected from WebSocket');\n    }\n  }\n\n  isConnected() {\n    return this.connected;\n  }\n}\n\nconst notificationService = new NotificationService();\nexport default notificationService;\n"],"mappings":"AAAA,OAAOA,MAAM,MAAM,eAAe;AAClC,SAASC,KAAK,QAAQ,SAAS;AAE/B,MAAMC,mBAAmB,CAAC;EACxBC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACC,WAAW,GAAG,IAAI;IACvB,IAAI,CAACC,SAAS,GAAG,KAAK;EACxB;EAEAC,OAAOA,CAACC,QAAQ,EAAE;IAChB,MAAMC,aAAa,GAAGA,CAAA,KAAM,IAAIR,MAAM,CAAC,0BAA0B,CAAC;IAClE,IAAI,CAACI,WAAW,GAAG,IAAIK,WAAW,CAAC;MACjCC,gBAAgB,EAAEF,aAAa;MAC/BG,cAAc,EAAE,IAAI;MACpBC,SAAS,EAAEA,CAAA,KAAM;QACf,IAAI,CAACP,SAAS,GAAG,IAAI;QACrBQ,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;QACrC,IAAI,CAACV,WAAW,CAACW,SAAS,CAAC,sBAAsB,EAAGC,OAAO,IAAK;UAC9D,MAAMC,YAAY,GAAGC,IAAI,CAACC,KAAK,CAACH,OAAO,CAACI,IAAI,CAAC;UAC7Cb,QAAQ,CAAC;YACPc,IAAI,EAAE,aAAa;YACnBC,IAAI,EAAEL;UACR,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ,CAAC;MACDM,YAAY,EAAGC,KAAK,IAAK;QACvBX,OAAO,CAACY,KAAK,CAAC,wBAAwB,EAAED,KAAK,CAACE,OAAO,CAAC,SAAS,CAAC,CAAC;QACjEb,OAAO,CAACY,KAAK,CAAC,qBAAqB,EAAED,KAAK,CAACJ,IAAI,CAAC;MAClD,CAAC;MACDO,gBAAgB,EAAEA,CAAA,KAAM;QACtB,IAAI,CAACtB,SAAS,GAAG,KAAK;QACtBQ,OAAO,CAACe,IAAI,CAAC,6BAA6B,CAAC;MAC7C,CAAC;MACDC,KAAK,EAAEA,CAAA,KAAM,CAAC;IAChB,CAAC,CAAC;IACF,IAAI,CAACzB,WAAW,CAAC0B,QAAQ,CAAC,CAAC;EAC7B;EAEAC,UAAUA,CAAA,EAAG;IACX,IAAI,IAAI,CAAC3B,WAAW,EAAE;MACpB,IAAI,CAACA,WAAW,CAAC4B,UAAU,CAAC,CAAC;MAC7B,IAAI,CAAC3B,SAAS,GAAG,KAAK;MACtBQ,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;IAC5C;EACF;EAEAmB,WAAWA,CAAA,EAAG;IACZ,OAAO,IAAI,CAAC5B,SAAS;EACvB;AACF;AAEA,MAAM6B,mBAAmB,GAAG,IAAIhC,mBAAmB,CAAC,CAAC;AACrD,eAAegC,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}